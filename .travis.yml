env:
  global:
  - CC_TEST_REPORTER_ID=d1c09e20447ae8db9c52cc5e8e6a8da876b2ffbb726f5b24f951e0ce8dc11367
  - secure: Yf82vHEklwjo8CTXegC9t1OxWTGyN48FiEZD0B1GoXiatQfh3rLwuAmiLUJiITkEsBRonQTyRXuKmmxFOd4uCGQbXqsvI/bUvjDP/wAs81ufBbu+jFldr2DbG6CyyUB0QGEA5JsjwCZ/uYYg5DhWswGjIgps/VEgxIDxZnlZ4GvkUnE28docbOlL11oZHjLUHU0Us8gWqkPi14nfXh+mZmRLhZ7FtAftVzedY9Fprqaj+ytJMghPwrU5cBPpv3SWtenioH7zK8/DJF0tB4A15A/1Q+BPAFAkFfXP6t0ONysI2Qyn/xatWMZ8JBiQlekY7TFsurzdDPRRoqryYCSHEsFpyJlBxpsqHMeAjuVBR0KSO9nmAhyFoblidqRe72p/f7jg4JZSdsOj145WZHUGB3y0zmlKxtpFCFIR/ruNHgf2K1jtaX4yXRBkTXk2et/f5zJnpce7Z54o2C9Ge9osGHjHV85FNZHvalJQfwS3/JCuuql3YTUiS5x/PNy2/YaMPiuBM8FeMsahmbPts98J+30k7aTrEB3CrI84VKUNm7WF7kVlR8LjROr5wkK+YqDRf1JMpi4EU0hWWF0ldWwnKBlUOCxRgevnxE32E3VePCI16oT9QpP+fdjPjPGJWv38o7Y0Xy2q1Fc7q1NJbDVY6RPqwoCP13klASPQ6yAPKu4=
language: python
python:
- '3.6'
before_install:
- pip install poetry
install:
- make install
services:
- postgresql
before_script:
- curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
- chmod +x ./cc-test-reporter
- ./cc-test-reporter before-build
- psql -c 'create database travis_ci_test;' -U postgres
script:
- export SECRET_KEY=$SECRET_KEY
- make lint
- make test
after_script:
- "./cc-test-reporter format-coverage -d -t coverage.py coverage.xml after-build $TRAVIS_TEST_RESULT"
- if [[ "$TRAVIS_TEST_RESULT" == 0 ]]; then ./cc-test-reporter upload-coverage; fi
